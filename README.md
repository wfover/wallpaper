# Wallpaper Gallery

一个高雅大气的壁纸展示网站,基于 Vue 3 + Vite 7 构建,完美适配桌面端和移动端。

## ✨ 特性

### 🎨 核心功能

- **高清壁纸展示** - 支持 4K 及更高分辨率壁纸
- **三大系列** - 电脑壁纸、手机壁纸、头像,根据设备智能推荐
- **智能裁剪** - PC 端电脑壁纸智能裁剪功能
  - 自动适配当前屏幕分辨率
  - 多种比例预设(16:9、21:9、16:10、4:3、iPad、iPhone、安卓全面屏等)
  - 自定义分辨率输入
  - 实时预览 + 沉浸式全屏预览
  - 原图质量输出选项
- **竖屏壁纸弹窗** - 移动端专属竖屏壁纸预览体验
- **智能搜索** - 实时搜索建议、关键词高亮、回车确认搜索
- **多种排序** - 按时间、大小、名称排序
- **动态分类** - 自动从壁纸数据中提取分类,按数量排序
- **格式筛选** - 按 JPG/PNG 格式筛选
- **一键下载** - 直接下载原图

### 🖼️ 视图与浏览

- **多视图模式**
  - 桌面端:网格/列表/瀑布流,支持 GSAP Flip 动画丝滑切换
  - 移动端:网格/列表/瀑布流,支持手势左右滑动切换视图
- **丝滑切换动画** - 基于 GSAP Flip 插件的视图模式切换动画,卡片平滑形变过渡
- **移动端 Flex 瀑布流** - 采用 Flex + JS 分列算法
- **导航滑块动画** - 系列切换时背景滑块平滑过渡,避免元素抖动
- **动态宽高比** - 根据系列自动适配卡片比例(电脑16:10、手机9:16、头像1:1)
- **全屏浏览** - 沉浸式全屏浏览模式,ESC 退出
- **移动端无限滚动** - 滚动到底部自动加载更多
- **今日精选** - 每日随机推荐精选壁纸(仅电脑壁纸系列)

### 💫 用户体验

- **智能设备检测** - 综合 User Agent、触摸支持、屏幕尺寸判断设备类型
- **主题切换** - 深色/浅色主题,自动跟随系统
- **响应式设计** - 完美适配桌面端和移动端
- **欢迎横幅** - 首页精美渐变横幅,告知用户网站更新计划,可关闭并记住状态
- **移动端优化**
  - 底部筛选弹窗
  - 顶部搜索弹窗
  - 侧边导航抽屉
  - 手势滑动切换视图
- **用户偏好记忆** - 记住用户的系列选择、排序方式、视图模式
- **本地缩略图** - 预生成 WebP 缩略图,首页加载更快

### 🧭 路由与导航

- **智能重定向** - 首次访问根据设备类型自动跳转到推荐系列
- **偏好优先** - 用户明确选择的系列优先于设备推荐
- **循环检测** - 防止路由守卫产生无限循环
- **历史优化** - 使用 replace 避免污染浏览历史

## 🛠️ 技术栈

| 类别 | 技术 |
| --- | --- |
| 框架 | Vue 3.5 (Composition API + script setup) |
| 构建工具 | Vite 7 |
| UI 组件 | Element Plus (PC端) + Vant (移动端) |
| 动画 | GSAP + Flip 插件 |
| 图片裁剪 | Cropper.js |
| 样式 | Sass + postcss-pxtorem (移动端适配) |
| 路由 | Vue Router 4 |
| 代码混淆 | javascript-obfuscator (自定义 Vite 插件) |
| 部署 | GitHub Pages + GitHub Actions |

### 🔄 自动化部署

项目采用全自动 CI/CD 流程:

| 时间 | 事件 | 说明 |
|------|------|------|
| 每日 8:00 | 前端构建 | 自动获取最新 CDN 版本号并部署 |

**CDN 版本自动管理**:
- 构建时自动从图床仓库 API 获取最新 tag
- 无需手动修改代码中的版本号
- `src/utils/constants.js` 中的版本号仅作为本地开发默认值

```
图床打 tag (v1.0.5) → 前端构建时 API 获取 → 自动替换版本号 → 部署
```

## 🚀 开发

```bash
# 安装依赖
pnpm install

# 启动开发服务器
pnpm dev

# 生成壁纸数据(三个系列)
pnpm generate

# 构建生产版本
pnpm build

# 预览构建结果
pnpm preview
```

## 📁 项目结构

```text
wallpaper-gallery/
├── .github/workflows/    # GitHub Actions 配置
├── public/
│   └── data/             # 壁纸数据 JSON(构建时生成)
│       ├── desktop.json  # 电脑壁纸数据
│       ├── mobile.json   # 手机壁纸数据
│       └── avatar.json   # 头像数据
├── scripts/
│   └── generate-data.js  # 数据生成脚本(含加密)
├── build/
│   └── vite-plugin-obfuscate.js # 自定义混淆插件
├── src/
│   ├── assets/styles/    # 全局样式(Sass)
│   ├── components/       # Vue 组件
│   │   ├── common/       # 通用组件(搜索、筛选、回到顶部等)
│   │   ├── home/         # 首页组件(今日精选)
│   │   ├── layout/       # 布局组件(头部、底部)
│   │   └── wallpaper/    # 壁纸相关组件
│   ├── composables/      # 组合式函数
│   │   ├── useDevice.js       # 设备检测(UA、触摸、屏幕尺寸)
│   │   ├── useFilter.js       # 筛选与动态分类
│   │   ├── usePagination.js   # 传统分页(页码跳转、每页条数)
│   │   ├── useTheme.js        # 主题管理
│   │   ├── useViewMode.js     # 视图模式
│   │   ├── useWallpapers.js   # 壁纸数据管理
│   │   └── useWallpaperType.js # 系列管理
│   ├── router/           # Vue Router 路由配置(智能重定向)
│   ├── views/            # 页面视图组件
│   └── utils/            # 工具函数和常量
│       ├── constants.js      # 常量配置(动态 URL 构建)
│       ├── format.js         # 格式化工具函数
│       ├── codec.js          # 数据编解码
│       └── codec-config.js   # 编解码配置
└── index.html
```

## 📱 三大系列

| 系列 | 路由 | 设备可见性 | 宽高比 |
| --- | --- | --- | --- |
| 电脑壁纸 | `/desktop` | PC 端 | 16:10 |
| 手机壁纸 | `/mobile` | 移动端 | 9:16 |
| 头像 | `/avatar` | 全设备 | 1:1 |

- PC 端显示:电脑壁纸 + 头像
- 移动端显示:手机壁纸 + 头像

### 图片加载策略

| 系列 | 列表展示 | 详情预览 | 优化策略 |
| --- | --- | --- | --- |
| 电脑壁纸 | `thumbnail/` 缩略图 (550px) | `wallpaper/` 原图 | 缩略图优先,快速加载 |
| 手机壁纸 | `preview/` 预览图 (1080px) | `wallpaper/` 原图 | 长屏使用预览图,更清晰 |
| 头像 | `thumbnail/` 缩略图 (550px) | `wallpaper/` 原图 | 缩略图即可满足需求 |
| 今日精选 | `wallpaper/` 原图 | - | 首页大图展示 |

**智能加载优先级**:
- mobile 系列:previewUrl (1080px 预览图) → thumbnailUrl → 原图
- 其他系列:thumbnailUrl (550px 缩略图) → 原图

**降级策略**:缩略图加载失败时自动切换到 [wsrv.nl](https://wsrv.nl) 代理服务生成缩略图,确保图片始终可用。

## 🎯 性能优化

- **CSS 内联** - 关键 CSS 内联到 HTML,加快首屏渲染
- **CLS 优化** - 图片占位符、滚动条预留空间,避免布局偏移
- **图片优化** - WebP 格式、缩略图预生成、懒加载
- **代码分割** - 路由级别代码分割,按需加载
- **预连接** - DNS 预解析、预连接到 CDN 域名

## 📊 SEO 优化

- **结构化数据** - Schema.org 标记,增强搜索引擎理解
- **Sitemap** - 自动生成站点地图
- **搜索引擎提交** - 支持百度主动推送、Google Search Console

## 📄 License

MIT
